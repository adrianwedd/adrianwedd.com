---
import BaseLayout from '../layouts/BaseLayout.astro';
import GitHubActivity from '../components/islands/GitHubActivity';
import { getCollection } from 'astro:content';

const blogPosts = (await getCollection('blog')).filter((p) => !p.data.draft);
const projects = await getCollection('projects');
const galleries = await getCollection('gallery');
const episodes = await getCollection('audio');

const totalWords = blogPosts.reduce((sum, p) => sum + (p.body ? p.body.split(/\s+/).length : 0), 0);
const totalImages = galleries.reduce((sum, g) => sum + g.data.images.length, 0);
---

<BaseLayout title="Now" description="What I'm focused on right now. Updated February 2026.">
  <article class="mx-auto max-w-3xl px-4 py-16 sm:px-6 lg:px-8">
    <header class="mb-12">
      <h1 class="text-text">Now</h1>
      <p class="mt-2 text-sm text-text-muted">
        Updated February 2026. This is a <a href="https://nownownow.com/about" target="_blank" rel="noopener">/now page</a>.
      </p>
    </header>

    <div class="space-y-8 leading-relaxed text-text">
      <section>
        <h2 class="text-text">Focus</h2>
        <p>
          Multi-agent AI safety. Specifically: what happens when individually safe agents are composed into systems, and
          why the safety properties don't transfer. The research sits under the
          <a href="/projects/failure-first/">Failure First</a> umbrella.
        </p>
      </section>

      <section>
        <h2 class="text-text">Building</h2>
        <ul class="mt-2 space-y-2">
          <li>This site — shipping improvements in weekly sprints</li>
          <li><a href="/projects/agentic-index/">Agentic Index</a> — benchmarking agent capabilities</li>
          <li>A pipeline that turns project documentation into audio overviews, infographics, and quizzes using NotebookLM Studio</li>
        </ul>
      </section>

      <section>
        <h2 class="text-text">Writing</h2>
        <p>
          Publishing more of the research that's been sitting in private repos. Recent pieces on
          <a href="/blog/jailbreak-archaeology/">jailbreak archaeology</a> and
          <a href="/blog/when-ai-systems-talk-safety-breaks/">multi-agent safety failures</a>.
          Working on a longer piece about why demonstrated risk is systematically ignored.
        </p>
      </section>

      <section>
        <h2 class="text-text">Looking for</h2>
        <p>
          Interesting work in AI safety, systems thinking, or infrastructure. Open to research collaborations,
          technical advisory roles, or full-time positions where the problems are real and the approach is honest.
        </p>
      </section>

      <section>
        <h2 class="text-text">Location</h2>
        <p>Tasmania, Australia.</p>
      </section>

      <section>
        <h2 class="text-text">This Site</h2>
        <div class="mt-4 grid grid-cols-2 gap-3 sm:grid-cols-4">
          <div class="rounded-lg border border-border bg-surface-alt px-4 py-3 text-center">
            <div class="text-xl font-semibold text-accent">{blogPosts.length}</div>
            <div class="text-xs text-text-muted">posts</div>
          </div>
          <div class="rounded-lg border border-border bg-surface-alt px-4 py-3 text-center">
            <div class="text-xl font-semibold text-accent">{projects.length}</div>
            <div class="text-xs text-text-muted">projects</div>
          </div>
          <div class="rounded-lg border border-border bg-surface-alt px-4 py-3 text-center">
            <div class="text-xl font-semibold text-accent">{totalImages}</div>
            <div class="text-xs text-text-muted">images</div>
          </div>
          <div class="rounded-lg border border-border bg-surface-alt px-4 py-3 text-center">
            <div class="text-xl font-semibold text-accent">{episodes.length}</div>
            <div class="text-xs text-text-muted">episodes</div>
          </div>
        </div>
        <p class="mt-3 text-xs text-text-muted">{totalWords.toLocaleString()} words written across {blogPosts.length} posts.</p>
      </section>

      <section>
        <h2 class="text-text">Recent Activity</h2>
        <p class="text-sm text-text-muted mb-4">Live from GitHub.</p>
        <GitHubActivity client:idle />
      </section>
    </div>

    <nav class="mt-16 border-t border-border pt-8" aria-label="Related pages">
      <div class="flex gap-6">
        <a href="/about/" class="text-sm text-text-muted transition-colors hover:text-accent">&larr; About</a>
        <a href="/projects/" class="text-sm text-text-muted transition-colors hover:text-accent">Projects &rarr;</a>
      </div>
    </nav>
  </article>
</BaseLayout>
