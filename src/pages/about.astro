---
import BaseLayout from '../layouts/BaseLayout.astro';
import Transparency from '../components/islands/Transparency.tsx';
import { getCollection } from 'astro:content';
import { slug } from '../lib/utils';

const featuredProjects = (await getCollection('projects'))
  .filter(p => p.data.featured)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 5);

const recentPosts = (await getCollection('blog'))
  .filter(p => !p.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 3);
---

<BaseLayout
  title="About"
  description="Adrian Wedd — AI safety researcher, systems analyst, and creative technologist based in Tasmania."
>
  <article class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
    <header class="mb-12">
      <h1 class="text-text">About</h1>
    </header>

    <div class="space-y-6 text-text leading-relaxed">
      <p>
        I'm Adrian Wedd. I live in Tasmania and I build things that think, break, and sometimes both.
      </p>

      <p>
        By day I work in systems integration and cybersecurity for Tasmania's public housing sector.
        By every other hour I'm an independent AI safety researcher — building the multi-agent systems
        I study, writing about what happens when demonstrated risk meets institutional optimism,
        and trying to publish more of what I make.
      </p>

      <p>
        My background spans environmental advocacy, government service, infrastructure management,
        and a consistent obsession with how complex systems fail. This site is where those threads converge.
      </p>

      <h2 class="text-text mt-12">What I'm Working On</h2>

      <p>
        Right now my focus is on AI safety frameworks that start from failure cases rather than success metrics,
        multi-agent coordination with physical safety constraints, and the gap between what we know
        about technological risk and what we do about it.
      </p>

      <p>
        I also write, make art, and occasionally record audio. This site is my workshop — not a portfolio,
        not a CV, but a space where finished work, ongoing experiments, and raw thinking coexist.
      </p>

      <h2 class="text-text mt-12">Elsewhere</h2>

      <ul class="space-y-2">
        <li>
          <a href="https://github.com/adrianwedd" target="_blank" rel="noopener">GitHub</a>
          <span class="text-text-muted"> — 115+ repos across AI, security, music tools, and more</span>
        </li>
        <li>
          <a href="https://failurefirst.org" target="_blank" rel="noopener">Failure First</a>
          <span class="text-text-muted"> — AI safety methodology</span>
        </li>
        <li>
          <a href="https://thiswasntinthebrochure.wtf" target="_blank" rel="noopener">This Wasn't in the Brochure</a>
          <span class="text-text-muted"> — a book about parenting and neurodivergence</span>
        </li>
      </ul>

      <h2 id="privacy" class="text-text mt-12">Privacy</h2>

      <p>
        This site respects your choices. No tracking happens without consent.
        Analytics (if enabled) uses Google Analytics 4 with cookie flags set to SameSite=Lax and Secure.
        Personalisation stores visit data locally in your browser — nothing leaves your machine.
      </p>

      <p>
        You can see exactly what this site knows about you and reset it at any time.
      </p>

      <Transparency client:load />
    </div>

    {/* Connected work */}
    {featuredProjects.length > 0 && (
      <aside class="mt-16 pt-8 border-t border-border">
        <h2 class="text-lg font-semibold text-text mb-4">Featured Work</h2>
        <div class="space-y-3">
          {featuredProjects.map(project => (
            <a
              href={project.data.url || `/projects/${slug(project.id)}/`}
              class="group flex items-center gap-3 no-underline"
            >
              <span class="text-sm text-text group-hover:text-accent transition-colors">
                {project.data.title}
              </span>
              <span class="text-xs text-text-muted">{project.data.description}</span>
            </a>
          ))}
        </div>
      </aside>
    )}

    {recentPosts.length > 0 && (
      <aside class="mt-8 pt-8 border-t border-border">
        <h2 class="text-lg font-semibold text-text mb-4">Recent Writing</h2>
        <div class="space-y-3">
          {recentPosts.map(post => (
            <a href={`/blog/${slug(post.id)}/`} class="group flex items-center gap-3 no-underline">
              <span class="text-sm text-text group-hover:text-accent transition-colors">
                {post.data.title}
              </span>
              <time class="text-xs text-text-muted" datetime={post.data.date.toISOString()}>
                {post.data.date.toLocaleDateString('en-AU', { day: 'numeric', month: 'short' })}
              </time>
            </a>
          ))}
        </div>
      </aside>
    )}
  </article>
</BaseLayout>
